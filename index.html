<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>PBSDex</title>

    <style>
        :root {
            --gap: 12px;
            --radius: 14px;
            --shadow: 0 6px 20px rgba(0,0,0,.08);
        }

        /* layout frame */
        body { font-family: system-ui, sans-serif; margin: 0; color: #111; background: #fafafa; }
        header { position: sticky; top: 0; background: #fff; padding: 12px; box-shadow: 0 1px 0 rgba(0,0,0,.08); z-index: 10; }
        .wrap { max-width: 1100px; margin: 0 auto; padding: 12px; }
        #grid { display: block; overflow: auto; max-height: 75vh; margin-top: 16px; }
        footer { padding: 40px 0; color: #666; text-align: center; }

        /* controls (search, filter, theme) */
        .controls {
            display: grid;
            grid-template-columns: 1fr 220px auto;
            gap: var(--gap);
            align-items: center;
        }
        input, select { padding: 10px 12px; border: 1px solid #ddd; border-radius: 10px; background: #fff; }
        .theme-btn {
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #fff;
            cursor: pointer;
        }
        @media (max-width: 720px) { .controls { grid-template-columns: 1fr auto; } }

        /* header back button lives inside #count */
        #count .header-back {
            appearance: none;
            border: 1px solid #ddd;
            background: #f8fafc;
            color: inherit;
            padding: 6px 10px;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 1px 0 rgba(0,0,0,.06);
        }
        #count .header-back:focus { outline: 2px solid #93c5fd; outline-offset: 2px; }

        /* =======================
           Main dex table styling
           ======================= */
        .dex-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            background: #fff;
            border-radius: 14px;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(0,0,0,.06);

            --col-icon: 44px;
            --col-name: 220px;
            --col-typing: 110px;   /* NEW */
            --col-ability: 180px;
            --col-hidden: 200px;
            --col-bst: 80px;
            --col-stat: 72px;
        }
        .dex-table th, .dex-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #e5e7eb;
            text-align: left;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-variant-numeric: tabular-nums;
        }
        .dex-table thead th { position: sticky; top: 0; background: #f3f4f6; font-weight: 700; z-index: 1; }
        .dex-table tbody tr:nth-child(odd) { background: #fafafa; }
        .dex-table tbody tr:nth-child(even) { background: #ffffff; }
        .dex-table tbody tr:hover { background: #ffeec2; transition: background 120ms ease-in-out; }

        /* 13 cols: icon + name + typing + ability1 + ability2 + hidden + 6 stats + BST */
        .dex-table th:nth-child(1),  .dex-table td:nth-child(1)  { width: var(--col-icon); }
        .dex-table th:nth-child(2),  .dex-table td:nth-child(2)  { width: var(--col-name); }
        .dex-table th:nth-child(3),  .dex-table td:nth-child(3)  { width: var(--col-typing); }
        .dex-table th:nth-child(4),  .dex-table td:nth-child(4),
        .dex-table th:nth-child(5),  .dex-table td:nth-child(5)  { width: var(--col-ability); }
        .dex-table th:nth-child(6),  .dex-table td:nth-child(6)  { width: var(--col-hidden); }
        /* stats: cols 7..12 */
        .dex-table th:nth-child(n+7):not(:nth-child(13)),
        .dex-table td:nth-child(n+7):not(:nth-child(13)) { width: var(--col-stat); }
        /* last col (13) is BST */
        .dex-table th:nth-child(13), .dex-table td:nth-child(13) { width: var(--col-bst); }

        /* center: icon, typing, all stats, BST */
        .dex-table th:nth-child(1),  .dex-table td:nth-child(1),
        .dex-table th:nth-child(3),  .dex-table td:nth-child(3),
        .dex-table th:nth-child(7),  .dex-table td:nth-child(7),
        .dex-table th:nth-child(8),  .dex-table td:nth-child(8),
        .dex-table th:nth-child(9),  .dex-table td:nth-child(9),
        .dex-table th:nth-child(10), .dex-table td:nth-child(10),
        .dex-table th:nth-child(11), .dex-table td:nth-child(11),
        .dex-table th:nth-child(12), .dex-table td:nth-child(12),
        .dex-table th:nth-child(13), .dex-table td:nth-child(13) { text-align: center; }

        /* table icons (left half of 128x64 shown) */
        .dex-table td.icon { text-align: center; }
        .dex-icon {
            width: 32px; height: 32px;
            object-fit: cover;
            object-position: left center;
            image-rendering: pixelated;
            display: block;
        }

        /* sorting affordance */
        th.sortable { cursor: pointer; user-select: none; }
        th.sortable .sort-arrow { opacity: .75; font-size: 12px; margin-left: 4px; }

        /* ability links look like plain text (table + detail) */
        .dex-table a.abil-link,
        .dex-table a.abil-link:visited,
        .detail a.abil-link,
        .detail a.abil-link:visited { color: inherit; text-decoration: none; }
        .dex-table a.abil-link:hover,
        .detail a.abil-link:hover { text-decoration: none; }
        .dex-table a.abil-link:focus,
        .detail a.abil-link:focus { outline: 2px solid #93c5fd; outline-offset: 2px; border-radius: 2px; }

        /* =======================
           Stat bars
           ======================= */
        .stats { width: 100%; border-collapse: collapse; }
        .stats td { padding: 6px 8px; border-bottom: 1px solid #eee; vertical-align: middle; }
        .stats td.label { width: 64px; white-space: nowrap; }
        .stats td.num { width: 48px; text-align: right; font-variant-numeric: tabular-nums; font-weight: 700; }
        .stats td.bar { width: 260px; }
        .statbar { position: relative; height: 12px; background: #f2f2f5; border-radius: 6px; box-shadow: inset 0 1px 2px rgba(0,0,0,.15); overflow: hidden; }
        .statbar::after {
            content: ""; position: absolute; inset: 0 auto 0 0; width: var(--w,0%);
            background: linear-gradient(to bottom, hsl(var(--h) 95% 60%), hsl(var(--h) 90% 50%));
            border-radius: 6px; box-shadow: inset 0 -1px 0 rgba(0,0,0,.25);
        }

        /* =======================
           Detail page layout
           ======================= */
        .detail { background: #fff; border-radius: 14px; box-shadow: 0 6px 20px rgba(0,0,0,.06); padding: 16px; min-height: 240px; }

        /* centered, proportional three-column layout */
        .mon-layout{
            display:grid;
            grid-template-columns:auto auto auto;   /* content-sized columns */
            column-gap:28px;                        /* equal spacing (was 32) */
            row-gap:16px;
            justify-content:center;                 /* center the whole group */
            align-items:center;                     /* vertically center columns */
        }

        /* left: artwork */
        .mon-art { justify-self: center; }
        .art-box {
            width: 288px; height: 288px;  /* 96 * 3 */
            background: #fff; border: 1px solid #ddd; border-radius: 16px;
            box-shadow: 0 6px 20px rgba(0,0,0,.08);
            display: flex; align-items: center; justify-content: center; margin: 0;
        }
        .mon-front { width: 288px; height: 288px; image-rendering: pixelated; object-fit: contain; display: block; }

        /* middle: typing + abilities */
        .mon-middle {
            width: 320px; display: grid; gap: 16px;
            align-items: stretch; justify-items: center;
        }
        .info-tile {
            width: 100%; background: #f5f6f8; border-radius: 14px; padding: 16px 18px;
            display: grid; grid-template-columns: 120px 1fr; gap: 12px; align-items: center;
            box-shadow: 0 1px 0 rgba(0,0,0,.05);
        }
        .info-label { color: #555; font-weight: 500; }
        .info-value.stacked { display: grid; gap: 6px; }
        .info-value.center { justify-items: center; text-align: center; }
        .info-value.stacked .line { font-weight: 700; }      /* bold values */
        .info-value .line em { font-style: italic; }         /* hidden ability italic */

        /* right: stats card */
        .mon-stats { justify-self: center; display: flex; }
        .stats-panel {
            width: 360px; max-width: 360px; margin: 0;
            background: #f5f6f8; border-radius: 14px; padding: 14px 16px;
            display: flex; align-items: center; justify-content: center;
        }

        /* tooltips for ability descriptions (white in light mode) */
        #tooltip {
            position: fixed; z-index: 2147483647; max-width: 36ch;
            padding: 8px 10px; border-radius: 8px; font-size: 12.5px; font-weight: 400; line-height: 1.25;
            pointer-events: none; opacity: 0; transform: translateY(4px);
            transition: opacity 100ms ease, transform 100ms ease;
            background: #fff; color: #111; border: 1px solid rgba(0,0,0,.12); box-shadow: 0 10px 28px rgba(0,0,0,.18);
        }
        #tooltip.show { opacity: 1; transform: translateY(0); }
        #tooltip::after {
            content: ""; position: absolute; width: 10px; height: 10px; left: 16px; top: -5px;
            transform: rotate(45deg); background: #fff; border-left: 1px solid rgba(0,0,0,.12); border-top: 1px solid rgba(0,0,0,.12);
        }

        /* responsive */
        @media (max-width: 1200px) { .mon-middle { width: 320px; } .stats-panel { width: 380px; max-width: 380px; } }
        @media (max-width: 980px)  { .mon-layout { grid-template-columns: auto auto; } .mon-stats { grid-column: 1 / -1; justify-content: center; } }
        @media (max-width: 720px)  {
            .mon-layout { grid-template-columns: 1fr; }
            .art-box { width: 240px; height: 240px; margin: 0 auto; } .mon-front { width: 240px; height: 240px; }
            .mon-middle, .stats-panel { width: 100%; max-width: 520px; }
            .info-tile { grid-template-columns: 1fr; text-align: center; } .info-label { justify-self: center; }
        }

        /* Type icons (table + detail) */
        .type-icons { display: inline-flex; gap: 8px; align-items: center; justify-content: center; }
        .type-icon  { width: 22px; height: 22px; image-rendering: pixelated; display: block; }
        .type-icons.big .type-icon { width: 44px; height: 44px; } /* detail page, 2x size */

        /* =======================
           Dark theme overrides
           ======================= */
        [data-theme="dark"] body { color: #e8ecf1; background: #0f1115; }
        [data-theme="dark"] header { background: #161a22; box-shadow: 0 1px 0 rgba(0,0,0,.6); }
        [data-theme="dark"] input, [data-theme="dark"] select, [data-theme="dark"] .theme-btn {
            background: #0f1115; color: #e8ecf1; border: 1px solid #2b3040;
        }
        [data-theme="dark"] #count .header-back { background: #121723; border-color: #2b3040; box-shadow: none; }
        [data-theme="dark"] .dex-table { background: #161a22; box-shadow: 0 6px 20px rgba(0,0,0,.35); }
        [data-theme="dark"] .dex-table thead th { background: #1b2030; color: #e8ecf1; }
        [data-theme="dark"] .dex-table th, [data-theme="dark"] .dex-table td { border-bottom: 1px solid #2b3040; color: #e8ecf1; }
        [data-theme="dark"] .dex-table tbody tr:nth-child(odd) { background: #141824; }
        [data-theme="dark"] .dex-table tbody tr:nth-child(even) { background: #111521; }
        [data-theme="dark"] .dex-table tbody tr:hover { background: #24314a; }
        [data-theme="dark"] .art-box { background: #161a22; border-color: #2b3040; box-shadow: 0 6px 20px rgba(0,0,0,.35); }
        [data-theme="dark"] .info-tile, [data-theme="dark"] .stats-panel { background: #141824; box-shadow: none; }
        [data-theme="dark"] .statbar { background: #20263a; }
        [data-theme="dark"] .statbar::after {
            background: linear-gradient(to bottom, hsl(var(--h) 80% 55%), hsl(var(--h) 75% 45%));
            box-shadow: inset 0 -1px 0 rgba(0,0,0,.45), 0 0 6px hsl(var(--h) 70% 55% / .25);
        }
        [data-theme="dark"] #tooltip { background: #0f1115; color: #e8ecf1; border: 1px solid #2b3040; box-shadow: 0 12px 32px rgba(0,0,0,.55); }
        [data-theme="dark"] #tooltip::after { background: #0f1115; border-left: 1px solid #2b3040; border-top: 1px solid #2b3040; }
        [data-theme="dark"] footer { color: #9aa3b2; }
    </style>
</head>
<body>
<header>
    <div class="wrap">
        <div class="controls">
            <input id="q" placeholder="Search name, type, ability…" />
            <select id="type"><option value="">All types</option></select>
            <button id="theme-toggle" class="theme-btn" title="Toggle dark mode">🌙</button>
        </div>
    </div>
</header>

<main class="wrap">
    <div id="count" style="margin:10px 2px; font-size:13px;"></div>
    <div id="grid"></div>
</main>

<footer>Built with Vite on GitHub Pages.</footer>

<!-- Dev uses /src/...; your build tool rewrites this to the bundled .js -->
<script type="module" src="/src/scripts/main.ts"></script>
</body>
</html>
